\documentclass{beamer}
% \usetheme{Madrid}


\usepackage{tikz}

% % neural network
% \usetikzlibrary{matrix,chains,positioning,decorations.pathreplacing,arrows}



% package to add wrapfigure
\usepackage{wrapfig}


% package to add graphs
\usepackage{pgfplots}

% packages to add images
\usepackage{graphicx}

% stuff for checkerboard
\usetikzlibrary{matrix.skeleton}
\tikzstyle{ball} = [circle, shading=ball, minimum size=1cm]
\newcommand{\bl}{\node [ball, ball color=black!80!white, draw=black!65!white, thin]{};}
\newcommand{\wh}{\node [ball, ball color=white] {};}

% stuff for decision trees
\usepackage{forest}

\tikzset{
Above/.style={
  midway,
  above,
  font=\scriptsize,
  text width=1.5cm,
  align=center,
  },
Below/.style={
  midway,
  below,
  font=\scriptsize,
  text width=1.5cm,
  align=center
  }
}

% Titular Information
	\title[NN and GA To Play Draughts] % (optional, only for long titles)
	{Playing Draughts using Neural Networks and Genetic Algorithms}
	\author[T. Nguyen] % (optional, for multiple authors)
	{Thien Nguyen}
	\institute[Durham] % (optional)
	{
	Department of Computer Science\\
	Durham University
	}
	\subject{Computer Science}
% ------------------------------

% Plan for 8 minutes.

	% A title slide: Project title, student name, course, date
	%  An outline: What are the elements of your talk?
	% A problem description, possibly both informal and formal
	% Motivation: Why do you want to solve this problem? Previous work, and how it relates to what you are doing
	% Your approach to solving the problem
	% What you have accomplished so far (not relevant for marking!) Analysis: How will you judge the outcome of your work?
	% A conclusion slide: What did or will you accomplish?
	% What still needs to be done
\begin{document}

% Title Frame
\frame{\titlepage}

% Outline Page
\begin{frame}

  \frametitle{Outline}
  %Content goes here
	%An outline: What are the elements of your talk?
	\begin{block}{Problem Description}
		% This is important information
	 \end{block}
	\begin{block}{Motivation}
	% This is important information
	\end{block}
	\begin{block}{Related Work}
	% This is important information
	\end{block}
	\begin{block}{Approach}
	% This is important information
	\end{block}
	\begin{block}{Curent Progress}
	% This is important information
	\end{block}
	\begin{block}{Conclusion}
		% This is important information
	\end{block}
	  
	%  \begin{alertblock}{This is an Alert block}
	%  This is an important alert
	%  \end{alertblock}
  
	%  \begin{exampleblock}{This is an Example block}
	%  This is an example 
	%  \end{exampleblock}
\end{frame}

% Problem Description
\begin{frame}
  \frametitle{Problem Description}
  \framesubtitle{A problem in Computer Science}
	% More content goes here
	% Why is it important?
	% Currently (except for AlphaGo Zero) are really good at exploiting human games and definining "intuition" from there.
	Presently, competitive Draughts AI players are currently designed to play at a fixed ability. \\
	While it has produced very competitive and intelligent players, they require manual modifications in order to improve its performance. This is due to their dependency on pre-defined move databases, where optimal moves are pre-calculated, and recalled when necessary. \\
	By combining Neural Networks and Genetic Algorithms, this issue could possibly be solved by creating a player that can grow in ability over time, without the dependency on move-banks.


\end{frame}

% Motivation
\begin{frame}
	\frametitle{Motivation}
	\framesubtitle{Why have I chosen to tackle this?}
	% Why do you want to solve this problem? Previous work, and how it relates to what you are doing
	%More content goes here

	- Enjoyed the AI Search module \\
	- Want to learn about Machine Learning (unfortunately not an option this year) \\
	- I love board games! \\

	% Interested in neural networks, really enjoyed AI Search submodule. Inherent competitiveness against peers
	% Not necessarily interested in solving something new; also not expected for a bachelors degree.
\end{frame}

% Related Work
\begin{frame}
	\frametitle{Related Work}
	\framesubtitle{Similar works of art but no cigar}
	% Why do you want to solve this problem? Previous work, and how it relates to what you are doing
	\begin{block}{Samuel (59')}
		Uses Genetic Algorithms to improve coefficents of a set of heuristics to evaluate Draughts games.
	\end{block}
	%More content goes here
	\begin{block}{Blondie24 (97')}
		Uses an Evolutionary Algorithm and Neural Networks to evaluate Draughts games. (Quite similar!)
	\end{block}

	 \begin{block}{Giraffe (15')}
		Uses contemporary machine learning techniques to train a Neural Network to evaluate Chess games.
	 \end{block}
	% Interested in neural networks, really enjoyed AI Search submodule. Inherent competitiveness against peers
	% Not necessarily interested in solving something new; also not expected for a bachelors degree.
\end{frame}

% Current Approach
\begin{frame}
	\frametitle{Current Approach}
	% Your approach to solving the problem
	\framesubtitle{How will I tackle this?}
	% Why do you want to solve this problem? Previous work, and how it relates to what you are doing
	%More content goes here
	\begin{itemize}
		\item Evaluate Checkerboard
		\item Choosing the Best Move
		\item Generating Agents
		\item Choosing the best Agents
		\item Making better Agents
		\item \ldots
		\item Profit!
	\end{itemize}

\end{frame}

% ----------------------------
% Neural Networks
% ----------------------------

% Example Checkers Game
\begin{frame}
	\frametitle{Checkerboard}
	\begin{figure}[ht!]
		\centering
		\includegraphics[width=50mm]{sampleGame.png}
		\caption{The indexes of the 32 pieces of the input layer are the immediate values of the positions on the board. \label{overflow}}
	\end{figure}
\end{frame}

% Example Neural Network Frame
\begin{frame}
	\frametitle{Neural Networks}
	\tikzset{%
		every neuron/.style={
			circle,
			draw,
			minimum size=0.9cm
			},
		neuron missing/.style={
			draw=none, 
			scale=4,
			text height=0.333cm,
			execute at begin node=\color{black}$\vdots$
		},
	}

	\begin{tikzpicture}[x=1.2cm, y=1.5cm, >=stealth]

	% draw nodes
		% % input values
		% \foreach \m/\l [count=\y] in {1,2,3,missing,4}
		% 	\node [every neuron/.try, neuron \m/.try] (input-\m) at (-0.5,2.5-\y) {};

		% input layer
		\foreach \m/\l [count=\y] in {1,2,3,missing,4}
		\node [every neuron/.try, neuron \m/.try] (input-\m) at (0,2.5-\y) {};
		
		% layer 1
		\foreach \m [count=\y] in {1,missing,2}
		\node [every neuron/.try, neuron \m/.try ] (hidden1-\m) at (2,2-\y*1.25) {};

		% layer 2
		\foreach \m [count=\y] in {1,missing,2}
		\node [every neuron/.try, neuron \m/.try ] (hidden2-\m) at (4,2-\y*1.25) {};

		% output layer
		\foreach \m [count=\y] in {1}
		\node [every neuron/.try, neuron \m/.try ] (output-\m) at (6,0.5-\y) {};

	% input layer
	\foreach \l [count=\i] in {1,2,3,n}
		\draw [<-] (input-\i) -- ++(-1,0)
		node [above, midway] {$I_{\l}$};

	% hidden 1
	\foreach \l [count=\i] in {{(1,1)},{(1,n)}}
		\node [above] at (hidden1-\i.north) {$H_{\l}$};

	% hidden 2
	\foreach \l [count=\i] in {(2,1),(2,n)}
		\node [above] at (hidden2-\i.north) {$H_{\l}$};

	% output layer
	\foreach \l [count=\i] in {1}
		\draw [->] (output-\i) -- ++(1,0)
		node [above, midway] {$O_\l$};

	% lines from input to hidden 1
	\foreach \i in {1,...,4}
		\foreach \j in {1,...,2}
			\draw [->] (input-\i) -- (hidden1-\j);
	
	% lines from hidden 1 to hidden 2
	\foreach \i in {1,...,2}
	\foreach \j in {1,...,2}
		\draw [->] (hidden1-\i) -- (hidden2-\j);

	% lines from hidden 2 to putput
	\foreach \i in {1,...,2}
		\foreach \j in {1}
			\draw [->] (hidden2-\i) -- (output-\j);

	% headings
	\foreach \l [count=\x from 0] in {Input, Hidden, Hidden, Ouput}
		\node [align=center, above] at (\x*2,2) {\l \\ layer};

	\end{tikzpicture}
\end{frame}

% Neural Network Math
\begin{frame}
	$Output = (Input + weight) * Activation Function + Bias$
\end{frame}

% Checkerboard Outline
\begin{frame}
	\frametitle{Checkerboard}
	\begin{figure}[ht!]
		\centering
		\includegraphics[width=50mm]{checkerboard.png}
		\caption{The indexes of the 32 pieces of the input layer are the immediate values of the positions on the board. \label{overflow}}
	\end{figure}
\end{frame}

% Applied Neural Network Diagram
\begin{frame}
	\frametitle{Neural Networks}
	\tikzset{%
		every neuron/.style={
			circle,
			draw,
			minimum size=0.9cm
			},
		neuron missing/.style={
			draw=none, 
			scale=4,
			text height=0.333cm,
			execute at begin node=\color{black}$\vdots$
		},
	}

	\begin{tikzpicture}[x=1.2cm, y=1.5cm, >=stealth]

	% draw nodes
		% % input values
		% \foreach \m/\l [count=\y] in {1,2,3,missing,4}
		% 	\node [every neuron/.try, neuron \m/.try] (input-\m) at (-0.5,2.5-\y) {};

		% input layer
		\foreach \m/\l [count=\y] in {1,2,3,missing,4}
		\node [every neuron/.try, neuron \m/.try] (input-\m) at (0,2.5-\y) {};
		
		% layer 1
		\foreach \m [count=\y] in {1,missing,2}
		\node [every neuron/.try, neuron \m/.try ] (hidden1-\m) at (2,2-\y*1.25) {};

		% layer 2
		\foreach \m [count=\y] in {1,missing,2}
		\node [every neuron/.try, neuron \m/.try ] (hidden2-\m) at (4,2-\y*1.25) {};

		% output layer
		\foreach \m [count=\y] in {1}
		\node [every neuron/.try, neuron \m/.try ] (output-\m) at (6,0.5-\y) {};

	% input layer
	\foreach \l [count=\i] in {1,1.5,0,-1}
		\draw [<-] (input-\i) -- ++(-1,0)
		node [above, midway] {${\l}$};

	% hidden 1
	\foreach \l [count=\i] in {{0.25},{0.62}}
		\node [above] at (hidden1-\i.north) {${\l}$};

	% hidden 2
	\foreach \l [count=\i] in {-0.76, 0.24}
		\node [above] at (hidden2-\i.north) {${\l}$};

	% output layer
	\foreach \l [count=\i] in {0.21}
		\draw [->] (output-\i) -- ++(1,0)
		node [above, midway] {$\l$};

	% lines from input to hidden 1
	\foreach \i in {1,...,4}
		\foreach \j in {1,...,2}
			\draw [->] (input-\i) -- (hidden1-\j);
	
	% lines from hidden 1 to hidden 2
	\foreach \i in {1,...,2}
	\foreach \j in {1,...,2}
		\draw [->] (hidden1-\i) -- (hidden2-\j);

	% lines from hidden 2 to putput
	\foreach \i in {1,...,2}
		\foreach \j in {1}
			\draw [->] (hidden2-\i) -- (output-\j);

	% headings
	\foreach \l [count=\x from 0] in {Input, Hidden, Hidden, Ouput}
		\node [align=center, above] at (\x*2,2) {\l \\ layer};

	\end{tikzpicture}
\end{frame}

% Activation Function
\begin{frame}

	\begin{figure}
			\centering
		
			\begin{tikzpicture}
					\fontsize{8}{11}
					\begin{axis}[
							legend pos=north west,
							axis x line=middle,
							axis y line=middle,
							x tick label style={/pgf/number format/fixed,
																	/pgf/number format/fixed zerofill,
																	/pgf/number format/precision=1},
							y tick label style={/pgf/number format/fixed,
																	/pgf/number format/fixed zerofill,
																	/pgf/number format/precision=1},
							grid = major,
							width=100mm,
							height=7cm,
							grid style={dashed, gray!30},
							xmin=-5,     % start the diagram at this x-coordinate
							xmax= 5,    % end   the diagram at this x-coordinate
							ymin= -1,     % start the diagram at this y-coordinate
							ymax= 1,   % end   the diagram at this y-coordinate
							%axis background/.style={fill=white},
							xlabel=x,
							ylabel=y,
							tick align=outside,
							enlargelimits=false]
					% plot the stirling-formulae
					\addplot[domain=-5:5, red, ultra thick,samples=500] {2*(1/(1+e^-x))-1};
					% \addlegendentry{$f(x)=\frac{1}{1+e^{-5x}}$}
					\end{axis}
			\end{tikzpicture}
			\caption{graph of modified sigmoid function $f(x)={\frac{2}{1+e^{-x}}- 1}$ \label{sigmoid}}
	\end{figure}
\end{frame}

% Decision Tree
\begin{frame}
	\frametitle{Choosing moves}

	\begin{forest} 
		for tree={
			grow=east,
			draw=cyan,
			circle,
			line width=0.2pt,
			parent anchor=east,
			child anchor=west,
			edge={draw=cyan},
			edge label={\Huge\color{black}},
			edge path={
				\noexpand\path[\forestoption{edge}]
					(!u.parent anchor) -- ([xshift=-1.6cm].child anchor) --    
					(.child anchor)\forestoption{edge label};
			},
			l sep=2cm,
		} 
		[,rectangle, s sep=35pt,
			[,edge label={node[Below]{option1}}
				[,edge label={node[Below]{a longer text goes here}}
				]
				[,edge label={node[Above]{text}}
				]
			]
			[,edge label={node[Below]{option1}}
				[,edge label={node[Below]{a longer text goes here}}
				]
				[,edge label={node[Above]{text}}
				]
			]
			[,edge label={node[Above]{option2}}
				[,edge label={node[Below]{a longer text goes here}}
				]
				[,edge label={node[Above]{text}}
				]
			]
		]
		\end{forest}
\end{frame}

% ----------------------------
% Generating Agents
% ----------------------------

\begin{frame}
	\frametitle{Generating Agents}
	An agent is a generated set of weights for the neural network.
\end{frame}

\begin{frame}
	\frametitle{Tournament}
	\begin{enumerate}
		\item Generate a population of random agents
		\item Make agents play each other
		\item Order agents by the amount of points scored
		\item The best few agents are chosen to stay on for the next tournament
		\item make new agents from those best few
		\item the losers are destroyed
		\item repeat step 2-6 with the new agents until satisfied
	\end{enumerate}
\end{frame}

% ----------------------------
% Genetic Algorithms
% ----------------------------

\begin{frame}
	\frametitle{Crossover Mechanism}
\end{frame}

\begin{frame}
	\frametitle{Mutation}
\end{frame}

% Template
\begin{frame}
	\frametitle{Template}
\end{frame}
% ----------------------------

% Current Progress
\begin{frame}
	\frametitle{Current Progress}
	% Your approach to solving the problem
	% How will I Judge the outcome of the work?
	\framesubtitle{What have I done already?}

	- I've created a relatively ok AI bot. \\
	- It plays relatively well! \\

\end{frame}

% Remaining Work
\begin{frame}
	\frametitle{Remaining Work}
	\framesubtitle{What do I still need to do?}
	% What did or will you accomplish?
	% What still needs to be done
	% \framesubtitle{A bit more information about this}
\end{frame}

% Conclusion
\begin{frame}
	\frametitle{Conclusion}
	\framesubtitle{What will I accomplish?}
	I will hopefully accomplish something.
	% What did or will you accomplish?
	% What still needs to be done
	% \framesubtitle{A bit more information about this}
\end{frame}

% References
\begin{frame}
	\frametitle{References}
	\framesubtitle{Nanos gigantum humeris insidentes}
	% What did or will you accomplish?
	References!
	% What still needs to be done
	% \framesubtitle{A bit more information about this}
\end{frame}

\end{document}